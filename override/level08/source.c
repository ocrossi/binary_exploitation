#include <sting.h>
#include <stdio.h>
#include <unistd.h>
#include <stlib.h>
#include <fcntl.h>


void log_wrapper(int fd, char *s, char *toopen) {
   // 0x00000000004008c4 <+0>:	push   rbp
   // 0x00000000004008c5 <+1>:	mov    rbp,rsp
   // 0x00000000004008c8 <+4>:	sub    rsp,0x130
   // 0x00000000004008cf <+11>:	mov    QWORD PTR [rbp-0x118],rdi
   // 0x00000000004008d6 <+18>:	mov    QWORD PTR [rbp-0x120],rsi
   // 0x00000000004008dd <+25>:	mov    QWORD PTR [rbp-0x128],rdx
   // 0x00000000004008e4 <+32>:	mov    rax,QWORD PTR fs:0x28
   // 0x00000000004008ed <+41>:	mov    QWORD PTR [rbp-0x8],rax
   // 0x00000000004008f1 <+45>:	xor    eax,eax
   // 0x00000000004008f3 <+47>:	mov    rdx,QWORD PTR [rbp-0x120]
   // 0x00000000004008fa <+54>:	lea    rax,[rbp-0x110]
   // 0x0000000000400901 <+61>:	mov    rsi,rdx
   // 0x0000000000400904 <+64>:	mov    rdi,rax
   // 0x0000000000400907 <+67>:	call   0x4006f0 <strcpy@plt>
	char buff[264];
	int len_p1;
	int len_p2;


	strcpy(buff, s);
	len_p1 = strlen(buff);
	len_p2 = strlen(buff+len_p1);
	b
	snprintf(buf+len_p1, toopen, "%s\n", 254);
	
}


int main(int argc, char *argv[])
{
	int res_open;
	file *stream;

	if (argc != 2) {
		printf("Usage: %s filename\n", argv[0]);
	}
	res_open = fopen("./backups/.log" ,"w");
	if (res_open != 0) {
		printf("ERROR: Failed to open %s\n", "./backups/.log");
		exit(1);
	}
	log_wrapper(res_open, "Starting back up: ", argv[1]);
	stream = fopen(argv[1], "r");

	// 0x0000000000400b09 <+281>:	mov    edx,0x400dab 					edx = "./backups/"
	// 0x0000000000400b0e <+286>:	lea    rax,[rbp-0x70]					
	// 0x0000000000400b12 <+290>:	mov    rcx,QWORD PTR [rdx]
	// 0x0000000000400b15 <+293>:	mov    QWORD PTR [rax],rcx
	// 0x0000000000400b18 <+296>:	movzx  ecx,WORD PTR [rdx+0x8]
	// 0x0000000000400b1c <+300>:	mov    WORD PTR [rax+0x8],cx
	// 0x0000000000400b20 <+304>:	movzx  edx,BYTE PTR [rdx+0xa]
	// 0x0000000000400b24 <+308>:	mov    BYTE PTR [rax+0xa],dl
	// 0x0000000000400b27 <+311>:	lea    rax,[rbp-0x70]
	// 0x0000000000400b2b <+315>:	mov    QWORD PTR [rbp-0xa8],0xffffffffffffffff
	// 0x0000000000400b36 <+326>:	mov    rdx,rax
	// 0x0000000000400b39 <+329>:	mov    eax,0x0
	// 0x0000000000400b3e <+334>:	mov    rcx,QWORD PTR [rbp-0xa8]
	// 0x0000000000400b45 <+341>:	mov    rdi,rdx
	// 0x0000000000400b48 <+344>:	repnz scas al,BYTE PTR es:[rdi]
	// 0x0000000000400b4a <+346>:	mov    rax,rcx
	// 0x0000000000400b4d <+349>:	not    rax
	// 0x0000000000400b50 <+352>:	lea    rdx,[rax-0x1]
	// 0x0000000000400b54 <+356>:	mov    eax,0x63
	// 0x0000000000400b59 <+361>:	mov    rcx,rax
	// 0x0000000000400b5c <+364>:	sub    rcx,rdx
	// 0x0000000000400b5f <+367>:	mov    rdx,rcx
	// 0x0000000000400b62 <+370>:	mov    rax,QWORD PTR [rbp-0xa0]
	// 0x0000000000400b69 <+377>:	add    rax,0x8
	// 0x0000000000400b6d <+381>:	mov    rax,QWORD PTR [rax]
	// 0x0000000000400b70 <+384>:	mov    rcx,rax
	// 0x0000000000400b73 <+387>:	lea    rax,[rbp-0x70]
	// 0x0000000000400b77 <+391>:	mov    rsi,rcx
	// 0x0000000000400b7a <+394>:	mov    rdi,rax
	// 0x0000000000400b7d <+397>:	call   0x400750 <strncat@plt>

	

	return EXIT_SUCCESS;
}
