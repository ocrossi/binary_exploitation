#include <stdio.h>
#include <stdlib.h>
#include <string.h>


typedef struct message_body {
  char username[40];
  char body[140];
  int size;
}               t_msg;

void secret_backdoor(void)
{
  char command_input [128];
  
  fgets(command_input,0x80,stdin);
  system(command_input);
  return;
}

void set_msg(t_msg *body)
{
  long lVar1;
  ulong *it;
  char buffer [1024];
  
  it = (ulong *)buffer;
  for (lVar1 = 128; lVar1 != 0; lVar1 = lVar1 + -1) {
    *it = 0;
    it = it + 1;
  }
  puts(">: Msg @Unix-Dude");
  printf(">>: ");
  fgets(buffer,1024,stdin);
  strncpy(body->body,buffer,(long)(int)body->size);
  return;
}

void set_username(t_msg *body)
{
  long lVar1;
  int *it;
  int buffer [17];
  int i;
  
  it = buffer;
                    /* bzero(16) */
  for (lVar1 = 0x10; lVar1 != 0; lVar1 = lVar1 + -1) {
    *it = 0;
    it = it + 1;
  }
  puts(">: Enter your username");
  printf(">>: ");
  fgets((char *)buffer,0x80,stdin);
  for (i = 0; (i < 41 && (*(char *)((long)buffer + (long)i) != '\0')); i = i + 1) {
    body->username[i] = *(char *)((long)buffer + (long)i);
  }
  printf(">: Welcome, %s",body->username);
  return;
}


void handle_msg(void)
{
  t_msg msg;
  
  bzero(msg.username, 40);
  msg.size = 0x8c;
  set_username(&msg);
  set_msg(&msg);
  puts(">: Msg sent!");
  return;
}

int main(void)
{
  puts(
      "--------------------------------------------\n|   ~Welcome to l33t-m$n ~    v1337        |\n- -------------------------------------------"
      );
  handle_msg();
  return 0;
}
